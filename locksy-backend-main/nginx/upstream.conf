# Upstream Configuration for Backend Servers
# This file can be included in nginx.conf for easier management

# Backend API servers
upstream backend_servers {
    # Round-robin load balancing
    server localhost:3001 weight=1 max_fails=3 fail_timeout=30s;
    server localhost:3002 weight=1 max_fails=3 fail_timeout=30s;
    server localhost:3003 weight=1 max_fails=3 fail_timeout=30s;
    
    # Optional: Backup server
    # server localhost:3004 backup;
}

# Socket.IO servers with sticky sessions
upstream socketio_servers {
    # IP hash for session affinity (required for Socket.IO)
    ip_hash;
    
    server localhost:3001;
    server localhost:3002;
    server localhost:3003;
}

# Health check configuration
# Note: Requires nginx upstream health check module
# Or use external health check script

